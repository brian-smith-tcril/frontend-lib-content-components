{"version":3,"file":"index.js","names":["_react","_interopRequireDefault","require","_reactRedux","_propTypes","_tinymceReact","_store","_redux","_ImageUploadModal","_SourceCodeModal","_InsertLinkModal","hooks","_interopRequireWildcard","_messages","_jsxRuntime","_excluded","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","obj","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","key","value","_toPropertyKey","configurable","writable","_toPrimitive","String","Symbol","toPrimitive","TypeError","Number","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","propertyIsEnumerable","sourceKeys","editorConfigDefaultProps","setEditorRef","undefined","placeholder","initializeEditor","updateContent","content","minHeight","editorConfigPropTypes","PropTypes","func","any","TinyMceWidget","_ref","editorType","editorRef","disabled","id","courseId","editorContentHtml","assets","isLibrary","lmsEndpointUrl","studioEndpointUrl","onChange","editorConfig","translations","useTranslations","messages","isImgOpen","openImgModal","closeImgModal","imgModalToggle","isSourceCodeOpen","openSourceCodeModal","closeSourceCodeModal","sourceCodeModalToggle","isInsertLinkOpen","openInsertLinkModal","closeInsertLinkModal","insertLinkModalToggle","imagesRef","useImages","imageSelection","selectedImage","jsxs","Provider","store","children","jsx","isOpen","close","images","onClose","Editor","onEditorChange","exports","defaultProps","propTypes","string","bool","shape","mapStateToProps","state","selectors","app","learningContextId","_default","connect"],"sources":["../../../../src/editors/sharedComponents/TinyMceWidget/index.jsx"],"sourcesContent":["import React from 'react';\nimport { Provider, connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { Editor } from '@tinymce/tinymce-react';\n\nimport 'tinymce';\nimport 'tinymce/themes/silver';\nimport 'tinymce/skins/ui/oxide/skin.css';\nimport 'tinymce/icons/default';\nimport 'frontend-components-tinymce-advanced-plugins';\n\nimport store from '../../data/store';\nimport { selectors } from '../../data/redux';\nimport ImageUploadModal from '../ImageUploadModal';\nimport SourceCodeModal from '../SourceCodeModal';\nimport InsertLinkModal from '../InsertLinkModal';\nimport * as hooks from './hooks';\nimport messages from './messages';\nimport './customTinyMcePlugins/embedIframePlugin';\n\nconst editorConfigDefaultProps = {\n  setEditorRef: undefined,\n  placeholder: undefined,\n  initializeEditor: undefined,\n  updateContent: undefined,\n  content: undefined,\n  minHeight: undefined,\n};\n\nconst editorConfigPropTypes = {\n  setEditorRef: PropTypes.func,\n  placeholder: PropTypes.any,\n  initializeEditor: PropTypes.func,\n  updateContent: PropTypes.func,\n  content: PropTypes.any,\n  minHeight: PropTypes.any,\n};\n\nexport const TinyMceWidget = ({\n  editorType,\n  editorRef,\n  disabled,\n  id,\n  courseId,\n  editorContentHtml, // editorContent in html form\n  // redux\n  assets,\n  isLibrary,\n  lmsEndpointUrl,\n  studioEndpointUrl,\n  onChange,\n  ...editorConfig\n}) => {\n  const translations = hooks.useTranslations(messages);\n  const { isImgOpen, openImgModal, closeImgModal } = hooks.imgModalToggle();\n  const { isSourceCodeOpen, openSourceCodeModal, closeSourceCodeModal } = hooks.sourceCodeModalToggle(editorRef);\n  const { isInsertLinkOpen, openInsertLinkModal, closeInsertLinkModal } = hooks.insertLinkModalToggle();\n  const { imagesRef } = hooks.useImages({ assets, editorContentHtml });\n\n  const imageSelection = hooks.selectedImage(null);\n\n  return (\n    <Provider store={store}>\n      {isLibrary ? null : (\n        <ImageUploadModal\n          isOpen={isImgOpen}\n          close={closeImgModal}\n          editorRef={editorRef}\n          images={imagesRef}\n          editorType={editorType}\n          lmsEndpointUrl={lmsEndpointUrl}\n          {...imageSelection}\n        />\n      )}\n\n      {isInsertLinkOpen && (\n        <InsertLinkModal\n          isOpen={isInsertLinkOpen}\n          onClose={closeInsertLinkModal}\n          courseId={courseId}\n          editorRef={editorRef}\n          lmsEndpointUrl={lmsEndpointUrl}\n        />\n      )}\n      {editorType === 'text' ? (\n        <SourceCodeModal\n          isOpen={isSourceCodeOpen}\n          close={closeSourceCodeModal}\n          editorRef={editorRef}\n        />\n      ) : null}\n      <Editor\n        id={id}\n        disabled={disabled}\n        onEditorChange={onChange}\n        {...hooks.editorConfig({\n          openImgModal,\n          openSourceCodeModal,\n          openInsertLinkModal,\n          translations,\n          editorType,\n          editorRef,\n          isLibrary,\n          lmsEndpointUrl,\n          studioEndpointUrl,\n          images: imagesRef,\n          editorContentHtml,\n          ...imageSelection,\n          ...editorConfig,\n        })}\n      />\n    </Provider>\n  );\n};\nTinyMceWidget.defaultProps = {\n  isLibrary: null,\n  editorType: null,\n  editorRef: null,\n  lmsEndpointUrl: null,\n  studioEndpointUrl: null,\n  assets: null,\n  id: null,\n  disabled: false,\n  editorContentHtml: undefined,\n  updateContent: undefined,\n  onChange: () => ({}),\n  ...editorConfigDefaultProps,\n};\nTinyMceWidget.propTypes = {\n  editorType: PropTypes.string,\n  isLibrary: PropTypes.bool,\n  assets: PropTypes.shape({}),\n  editorRef: PropTypes.shape({}),\n  courseId: PropTypes.string,\n  lmsEndpointUrl: PropTypes.string,\n  studioEndpointUrl: PropTypes.string,\n  id: PropTypes.string,\n  disabled: PropTypes.bool,\n  editorContentHtml: PropTypes.string,\n  updateContent: PropTypes.func,\n  onChange: PropTypes.func,\n  ...editorConfigPropTypes,\n};\n\nexport const mapStateToProps = (state) => ({\n  assets: selectors.app.assets(state),\n  lmsEndpointUrl: selectors.app.lmsEndpointUrl(state),\n  studioEndpointUrl: selectors.app.studioEndpointUrl(state),\n  isLibrary: selectors.app.isLibrary(state),\n  courseId: selectors.app.learningContextId(state),\n});\n\nexport default (connect(mapStateToProps)(TinyMceWidget));\n"],"mappings":"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"}